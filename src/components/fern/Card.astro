---
export interface Props {
  title: string;
  icon?: string;
  iconSrc?: string;
  iconAlt?: string;
  href?: string;
}

const { title, icon, iconSrc, iconAlt = '', href } = Astro.props;

function iconFallback(value?: string): string {
  if (!value) return '';
  const normalized = value.toLowerCase();
  if (normalized.includes('rocket')) return 'ğŸš€';
  if (normalized.includes('slack')) return 'ğŸ’¬';
  if (normalized.includes('discord')) return 'ğŸ’¬';
  if (normalized.includes('envelope') || normalized.includes('mail')) return 'âœ‰ï¸';
  if (normalized.includes('github')) return 'ğŸ™';
  if (normalized.includes('shield')) return 'ğŸ›¡';
  if (normalized.includes('pen') || normalized.includes('write') || normalized.includes('edit')) return 'âœï¸';
  if (normalized.includes('bolt') || normalized.includes('flash')) return 'âš¡';
  if (normalized.includes('share') || normalized.includes('publish')) return 'ğŸ“¤';
  if (normalized.includes('rotate') || normalized.includes('refresh') || normalized.includes('arrows')) return 'ğŸ”„';
  if (normalized.includes('users') || normalized.includes('team')) return 'ğŸ‘¥';
  if (normalized.includes('clock')) return 'ğŸ•’';
  if (normalized.includes('plug')) return 'ğŸ”Œ';
  if (normalized.includes('lightbulb') || normalized.includes('brain')) return 'ğŸ’¡';
  if (normalized.includes('code')) return 'ğŸ’»';
  return 'â€¢';
}
---

{
  href ? (
    <a class="fern-card" href={href}>
      <h3 class="fern-card-title">
        {iconSrc ? (
          <img class="fern-card-icon-image" src={iconSrc} alt={iconAlt} loading="lazy" />
        ) : (
          icon && (
            <span aria-hidden="true" class="fern-card-icon">
              {iconFallback(icon)}
            </span>
          )
        )}
        {title}
      </h3>
      <div class="fern-card-body">
        <slot />
      </div>
    </a>
  ) : (
    <article class="fern-card">
      <h3 class="fern-card-title">
        {iconSrc ? (
          <img class="fern-card-icon-image" src={iconSrc} alt={iconAlt} loading="lazy" />
        ) : (
          icon && (
            <span aria-hidden="true" class="fern-card-icon">
              {iconFallback(icon)}
            </span>
          )
        )}
        {title}
      </h3>
      <div class="fern-card-body">
        <slot />
      </div>
    </article>
  )
}
