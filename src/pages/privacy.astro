---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';
import privacySource from '../../migration/legal-source/privacy-source.json';

const privacyParagraphs = privacySource.p.slice(6, -3);

const effectiveDate = privacyParagraphs[0];
const introParagraphs = privacyParagraphs.slice(1, 3);

const sections = [
  {
    title: '1. Information We Collect',
    opening: privacyParagraphs[3],
    groups: [
      {
        label: privacyParagraphs[4],
        items: privacyParagraphs.slice(5, 10),
      },
      {
        label: privacyParagraphs[10],
        items: privacyParagraphs.slice(11, 17),
      },
    ],
  },
  {
    title: '2. How We Use Your Information',
    opening: privacyParagraphs[17],
    items: privacyParagraphs.slice(18, 22),
  },
  {
    title: '3. Data Retention',
    paragraphs: [privacyParagraphs[22]],
  },
  {
    title: '4. Cookies and Tracking Technologies',
    paragraphs: [privacyParagraphs[23], privacyParagraphs[24]],
  },
  {
    title: '5. Sharing Your Information',
    opening: privacyParagraphs[25],
    items: privacyParagraphs.slice(26, 29),
  },
  {
    title: '6. Your Data Protection Rights',
    opening: privacyParagraphs[29],
    items: privacyParagraphs.slice(30, 36),
    paragraphs: [privacyParagraphs[36]],
  },
  {
    title: '7. Security of Your Information',
    paragraphs: [privacyParagraphs[37]],
  },
  {
    title: '8. Third-Party Links',
    paragraphs: [privacyParagraphs[38]],
  },
  {
    title: "9. Children's Privacy",
    paragraphs: [privacyParagraphs[39]],
  },
  {
    title: '10. Changes to This Privacy Policy',
    paragraphs: [privacyParagraphs[40]],
  },
];

const contactIntro = privacyParagraphs[41];
const contactEmailLine = privacyParagraphs[42];
const contactWebsiteLine = privacyParagraphs[43];
const contactEmail = contactEmailLine.replace(/^Email:\s*/i, '').trim();
const contactWebsite = contactWebsiteLine.replace(/^Website:\s*/i, '').trim();
---

<StarlightPage
  hasSidebar={false}
  headings={[]}
  frontmatter={{
    title: 'Privacy Policy',
    description: 'How Promptless handles data for the website and docs experience.',
    template: 'doc',
    editUrl: false,
    tableOfContents: false,
  }}
>
  <div class="pl-site-page pl-site-page-compact">
    <p><strong>{effectiveDate}</strong></p>

    {introParagraphs.map((paragraph) => <p>{paragraph}</p>)}

    {
      sections.map((section) => (
        <section>
          <h2>{section.title}</h2>
          {section.opening && <p>{section.opening}</p>}
          {
            section.groups?.map((group) => (
              <>
                <p><strong>{group.label}</strong></p>
                <ul>
                  {group.items.map((item) => <li>{item}</li>)}
                </ul>
              </>
            ))
          }
          {
            section.items && (
              <ul>
                {section.items.map((item) => <li>{item}</li>)}
              </ul>
            )
          }
          {section.paragraphs?.map((paragraph) => <p>{paragraph}</p>)}
        </section>
      ))
    }

    <section>
      <h2>11. Contact Us</h2>
      <p>{contactIntro}</p>
      <ul>
        <li>
          Email:{' '}
          <a href={`mailto:${contactEmail}`}>{contactEmail}</a>
        </li>
        <li>
          Website:{' '}
          <a href={contactWebsite}>{contactWebsite}</a>
        </li>
      </ul>
    </section>
  </div>
</StarlightPage>
